!function(t){return t.easyDonut=function(o,n){function e(t){var o=p.mulitBarColors||"#f44 #c44 #a44 #944 #444 blue green".split(" "),n=o.length;return o[t%n]}var i,a,s,r,l,c,u,p=this;return this.el=o,this.$el=t(o),this.$el.data("easyDonut",this),this.init=function(){var o,e;p.options=t.extend({},t.easyDonut.defaultOptions,n),o=parseInt(p.$el.data("percent"),10);var i=n.numbers||p.$el.data("numbers");p.numbers=i?t.isArray(i)?i:i.split(",").map(Number):null;var a=n.colors||p.$el.data("colors");return p.mulitBarColors=a?t.isArray(a)?a:a.split(","):null,p.percentage=0,p.canvas=t("<canvas width='"+p.options.size+"' height='"+p.options.size+"'></canvas>").get(0),p.$el.append(p.canvas),"undefined"!=typeof G_vmlCanvasManager&&null!==G_vmlCanvasManager&&G_vmlCanvasManager.initElement(p.canvas),p.ctx=p.canvas.getContext("2d"),window.devicePixelRatio>1&&(e=window.devicePixelRatio,t(p.canvas).css({width:p.options.size,height:p.options.size}),p.canvas.width*=e,p.canvas.height*=e,p.ctx.scale(e,e)),p.ctx.translate(p.options.size/2,p.options.size/2),p.ctx.rotate(p.options.rotate*Math.PI/180),p.$el.addClass("easyDonut"),p.$el.css({width:p.options.size,height:p.options.size,lineHeight:""+p.options.size+"px"}),p.update(p.numbers||o),p},this.update=function(o){return t.isArray(o)?(p.options.animate=!1,s(o),p):(o=parseFloat(o)||0,s([o,12]),p)},c=function(){var t,o,n;for(p.ctx.fillStyle=p.options.scaleColor,n=[],t=o=0;24>=o;t=++o)n.push(i(t));return n},i=function(t){var o;o=t%6===0?0:.017*p.options.size,p.ctx.save(),p.ctx.rotate(t*Math.PI/12),p.ctx.fillRect(p.options.size/2-o,0,.05*-p.options.size+o,1),p.ctx.restore()},u=function(){var t;t=p.options.size/2-p.options.lineWidth/2,p.options.scaleColor!==!1&&(t-=.08*p.options.size),p.ctx.beginPath(),p.ctx.arc(0,0,t,0,2*Math.PI,!0),p.ctx.closePath(),p.ctx.strokeStyle=p.options.trackColor,p.ctx.lineWidth=p.options.lineWidth,p.ctx.stroke()},l=function(){p.options.scaleColor!==!1&&c(),p.options.trackColor!==!1&&u()},s=function(t){function o(t){for(var o=0,n=0;n<t.length;n++)o+=t[n];return o}var n=o(t),e=t.map(function(t){return 100*t/n});l();for(var i=0,s=0;s<e.length;s++){var r=e[s];a(r,i,s),i+=r}},a=function(o,n,i){var a;p.ctx.strokeStyle=t.isFunction(p.options.barColor)?p.options.barColor(o):p.options.barColor,i>=0&&p.numbers?p.ctx.strokeStyle=e(i):l(),p.ctx.lineCap=p.options.lineCap,p.ctx.lineWidth=p.options.lineWidth,a=p.options.size/2-p.options.lineWidth/2,p.options.scaleColor!==!1&&(a-=.08*p.options.size),p.ctx.save(),p.ctx.rotate(-Math.PI/2),p.ctx.beginPath();var s,r;n>0?(s=2*Math.PI*n/100,r=2*Math.PI*(n+o)/100):(s=0,r=2*Math.PI*o/100),p.ctx.arc(0,0,a,s,r,!1),p.ctx.stroke(),p.ctx.restore()},r=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),this.init()},t.easyDonut.defaultOptions={barColor:"#ef1e25",trackColor:"#f2f2f2",scaleColor:"#dfe0e0",lineCap:"round",rotate:0,size:110,lineWidth:3,animate:!1,onStart:t.noop,onStop:t.noop,onStep:t.noop},void(t.fn.easyDonut=function(o){return t.each(this,function(n,e){var i,a;return i=t(e),i.data("easyDonut")?void 0:(a=t.extend({},o,i.data()),i.data("easyDonut",new t.easyDonut(e,a)))})})}(jQuery);
